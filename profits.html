<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>حساب الأرباح — Rasha Adel</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      background: url('background.jpg') center/cover fixed;
      font-family: 'Cairo', sans-serif;
    }

    .profit-box {
      background: rgba(255,255,255,0.93);
      padding: 25px;
      border-radius: 12px;
      text-align: center;
      margin-top: 30px;
      max-width: 420px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }

    .profit-box h3 { margin-bottom: 10px; color: #333; }
    input[type=number] {
      font-size: 1rem;
      padding: 8px;
      width: 65%;
      margin-bottom: 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      outline: none;
      text-align: center;
      transition: 0.3s;
    }
    input[type=number]:focus {
      border-color: #007bff;
      box-shadow: 0 0 5px rgba(0,123,255,0.4);
    }
    button.btn-primary {
      cursor: pointer;
      padding: 10px 25px;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      background-color: #007bff;
      color: white;
      transition: background-color 0.3s ease;
    }
    button.btn-primary:hover { background-color: #0056b3; }

    #totalIncomeDay, #netProfitDay, #totalIncomeMonth, #netProfitMonth {
      font-weight: bold;
      color: #28a745;
      font-size: 1.2rem;
      margin-bottom: 10px;
    }

    .footer-line { margin-top: 40px; text-align: center; font-size: 0.9rem; color: #555; }
    h2 { text-align: center; margin-top: 20px; color: #222; }
    .section { margin-bottom: 30px; }
  </style>
</head>
<body>
  
  <aside class="sidebar">
    <div class="brand">
      <img src="logo11.jpg" alt="Rasha Adel">
      <h1>Rasha Adel</h1>
      <p class="sub">Beauty Centre & Spa</p>
    </div>
    <nav class="nav">
      <a class="nav-item" href="dashboard_admin.html">لوحة المدير</a>
      <a class="nav-item" href="clients.html">العملاء</a>
      <a class="nav-item" href="invoice_admin.html">الفواتير</a>
      <a class="nav-item" href="invoice_log.html">سجل الفواتير</a>
      <a class="nav-item" href="services.html">الخدمات</a>
      <a class="nav-item" href="profits.html">حساب الأرباح</a>
      <a class="nav-item" href="register_customer_admin.html">تسجيل عميل</a>
      <a class="nav-item" href="index.html">تسجيل خروج</a>
    </nav>
  </aside>

  <main class="main">
    <div class="container">
      <h2>💰 حساب الأرباح</h2>

      <div class="profit-box section">
        <h3>إجمالي الدخل اليومي:</h3>
        <p id="totalIncomeDay">0 ج</p>
        <h3>مصروفات اليوم:</h3>
        <input id="expensesDay" type="number" placeholder="اكتب المصروفات (ج)">
        <br>
        <button class="btn btn-primary" onclick="calcProfit('day')">احسب صافي الربح اليومي</button>
        <h3>صافي الربح اليومي:</h3>
        <p id="netProfitDay">0 ج</p>
      </div>

      <div class="profit-box section">
        <h3>إجمالي الدخل الشهري:</h3>
        <p id="totalIncomeMonth">0 ج</p>
        <h3>مصروفات الشهر:</h3>
        <input id="expensesMonth" type="number" placeholder="اكتب المصروفات (ج)">
        <br>
        <button class="btn btn-primary" onclick="calcProfit('month')">احسب صافي الربح الشهري</button>
        <h3>صافي الربح الشهري:</h3>
        <p id="netProfitMonth">0 ج</p>
      </div>

      <div class="footer-line">
        © 2025 Rasha Adel Beauty Center & Spa — Designed & Developed by Mohamed Ali
      </div>
    </div>
  </main>

  <script src="app.js"></script>
  <script>
    // إجمالي الدخل اليومي
    function getTotalIncomeDay() {
      const invoices = window.app?.getTodayInvoices?.() || [];
      return invoices.reduce((sum, inv) => sum + (parseFloat(inv.final) || 0), 0);
    }

    // إجمالي الدخل الشهري
    function getTotalIncomeMonth() {
      const invoices = window.app?.getMonthlyInvoices?.() || [];
      return invoices.reduce((sum, inv) => sum + (parseFloat(inv.final) || 0), 0);
    }

    // حساب صافي الربح
    function calcProfit(period) {
      let income, expenses, netId;
      if (period === 'day') {
        income = getTotalIncomeDay();
        expenses = parseFloat(document.getElementById('expensesDay').value) || 0;
        netId = 'netProfitDay';
      } else if (period === 'month') {
        income = getTotalIncomeMonth();
        expenses = parseFloat(document.getElementById('expensesMonth').value) || 0;
        netId = 'netProfitMonth';
      }
      const profit = income - expenses;
      document.getElementById(netId).innerText = profit.toFixed(2) + ' ج';
    }

    function updateIncomeDisplay() {
      document.getElementById('totalIncomeDay').innerText = getTotalIncomeDay().toFixed(2) + ' ج';
      document.getElementById('totalIncomeMonth').innerText = getTotalIncomeMonth().toFixed(2) + ' ج';

      // إذا المصروفات مكتوبة، احسب الربح فورًا
      if (parseFloat(document.getElementById('expensesDay').value) > 0) calcProfit('day');
      if (parseFloat(document.getElementById('expensesMonth').value) > 0) calcProfit('month');
    }

    document.addEventListener('DOMContentLoaded', () => {
      updateIncomeDisplay();
      setInterval(updateIncomeDisplay, 60000); // تحديث تلقائي كل دقيقة
    });
  </script>
</body>
</html>
